<!doctype html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <link rel="stylesheet" href="./static/main.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js"
    integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ"
    crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <title>QR Copy</title>
</head>

<body>
  <div class="container">
    <div class="px-4 py-4 text-center">
      <h1 class="display-5 fw-bold text-body-emphasis">QR Copy</h1>
      <div class="col-lg-6 mx-auto">
        <p class="lead mb-4">Copy and paste across devices text using QR code!</p>
        

<script>
  function generateQRCode() {
    var textInput = $("#textInput").val().trim();
    if (textInput) {
      if (textInput.length > 1500) {    // word limit: 1500
        $("#alert").css("visibility", "visible");
      } else {
        $("#alert").css("visibility", "hidden");
      }
      $("#qrcode").html("");
      new QRious({
        element: document.getElementById("qrcode"),
        value: getPasteURL(textInput),
        size: 400
      });
    } else {
      clearField();
    }
  }

  function getPasteURL(text){
    return document.URL + "/" + encodeURIComponent(text);
  }

  function clearField() {
    $("#textInput").val("");
    $("#alert").css("visibility", "hidden");
    $("#qrcode-container").html('<canvas id="qrcode"></canvas>');
  }

  $(window).on("load", function () {
    $("#textInput").on("keypress", function (event) {
      if (event.key === "Escape") {
        event.preventDefault();
        $("#textInput").blur();
      }
    });
  });

</script>

<div>
  <textarea type="text" class="form-control mb-4" placeholder="Enter text here" id="textInput" maxlength="1501" rows="4"
    oninput="generateQRCode()"></textarea>
  <div class="mb-4">
    <button type="button" class="btn btn-outline-secondary" id="clear" onclick="clearField()">Clear</button>
    <button type="button" class="btn btn-primary" id="generate" onclick="generateQRCode()">Generate QR Code</button>
  </div>
</div>

<div id="qrcode-container" class="text-center">
  <canvas id="qrcode"></canvas>
</div>


      </div>
    </div>
  </div>
</body>

</html>